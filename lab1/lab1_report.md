University: [ITMO University](https://itmo.ru/ru/) 
Faculty: [FICT](https://fict.itmo.ru) 
Course: [Introduction to distributed technologies](https://github.com/itmo-ict-faculty/introduction-to-distributed-technologies) 
Year: 2023/2024 
Group: K4113c 
Author: Petrov Aleksandr Denisovich 
Lab: Lab1 
Date of create: 03.10.2023 
Date of finished: to be added
___

# –û—Ç—á—ë—Ç –æ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ–π —Ä–∞–±–æ—Ç–µ ‚Ññ1

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Docker –∏ Minikube, –º–æ–π –ø–µ—Ä–≤—ã–π –º–∞–Ω–∏—Ñ–µ—Å—Ç.

- [–û–ø–∏—Å–∞–Ω–∏–µ —Ä–∞–±–æ—Ç—ã](#–æ–ø–∏—Å–∞–Ω–∏–µ-—Ä–∞–±–æ—Ç—ã)
- [–¶–µ–ª—å —Ä–∞–±–æ—Ç—ã](#—Ü–µ–ª—å-—Ä–∞–±–æ—Ç—ã)
- [–•–æ–¥ —Ä–∞–±–æ—Ç—ã](#—Ö–æ–¥-—Ä–∞–±–æ—Ç—ã)
  * [–ó–∞–ø—É—Å–∫ minikube:](#–∑–∞–ø—É—Å–∫-minikube)
  * [–ó–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ vault](#–∑–∞–ø—É—Å–∫-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞-vault)
  * [–°–µ—Ä–≤–∏—Å –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—É](#—Å–µ—Ä–≤–∏—Å-–¥–ª—è-–¥–æ—Å—Ç—É–ø–∞-–∫-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—É)
  * [–ü–æ–∏—Å–∫ —Ç–æ–∫–µ–Ω–∞](#–ø–æ–∏—Å–∫-—Ç–æ–∫–µ–Ω–∞)
  * [–û—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–ª–∞—Å—Ç–µ—Ä–∞](#–æ—Å—Ç–∞–Ω–æ–≤–∫–∞-–∫–ª–∞—Å—Ç–µ—Ä–∞)
- [–í–æ–ø—Ä–æ—Å—ã –∫ —Ä–∞–±–æ—Ç–µ](#–≤–æ–ø—Ä–æ—Å—ã-–∫-—Ä–∞–±–æ—Ç–µ)
  * [1. –ß—Ç–æ —Å–µ–π—á–∞—Å –ø—Ä–æ–∏–∑–æ—à–ª–æ –∏ —á—Ç–æ —Å–¥–µ–ª–∞–ª–∏ –∫–æ–º–∞–Ω–¥—ã —É–∫–∞–∑–∞–Ω–Ω—ã–µ —Ä–∞–Ω–µ–µ?](#1-—á—Ç–æ-—Å–µ–π—á–∞—Å-–ø—Ä–æ–∏–∑–æ—à–ª–æ-–∏-—á—Ç–æ-—Å–¥–µ–ª–∞–ª–∏-–∫–æ–º–∞–Ω–¥—ã-—É–∫–∞–∑–∞–Ω–Ω—ã–µ-—Ä–∞–Ω–µ–µ)
  * [2. –ì–¥–µ –≤–∑—è—Ç—å —Ç–æ–∫–µ–Ω –¥–ª—è –≤—Ö–æ–¥–∞ –≤ Vault?](#2-–≥–¥–µ-–≤–∑—è—Ç—å-—Ç–æ–∫–µ–Ω-–¥–ª—è-–≤—Ö–æ–¥–∞-–≤-vault)

### –û–ø–∏—Å–∞–Ω–∏–µ —Ä–∞–±–æ—Ç—ã
–≠—Ç–æ –ø–µ—Ä–≤–∞—è –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –∫—É—Ä—Å–∞, –≤ —Ö–æ–¥–µ –∫–æ—Ç–æ—Ä–æ–π –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç—Å—è —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å Minikube —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Docker –≤ –∫–∞—á–µ—Å—Ç–≤–µ –¥—Ä–∞–π–≤–µ—Ä–∞ –∏ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å –ø–µ—Ä–≤—ã–π –ø–æ–¥. 
### –¶–µ–ª—å —Ä–∞–±–æ—Ç—ã
–û–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è —Å Docker –∏ Minikube, —Å–æ–∑–¥–∞—Ç—å –º–∞–Ω–∏—Ñ–µ—Å—Ç –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –ø–æ–¥–∞, –∑–∞–ø—É—Å—Ç–∏—Ç—å –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–¥. 
### –•–æ–¥ —Ä–∞–±–æ—Ç—ã
–î–ª—è –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –æ–±—Ä–∞–∑ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω—ã Linux Ubuntu 22.04 –¥–ª—è VirtualBox. –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –í–ú –≤—ã—Å—Ç–∞–≤–ª–µ–Ω—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º minikube.
#### –ó–∞–ø—É—Å–∫ minikube:
```
$ minikube start
üòÑ  minikube v1.31.2 on Ubuntu 22.04 (vbox/amd64)
‚ú®  Automatically selected the docker driver. Other choices: none, ssh
üìå  Using Docker driver with root privileges
üëç  Starting control plane node minikube in cluster minikube
üöú  Pulling base image ...
üî•  Creating docker container (CPUs=2, Memory=2200MB) ...
üê≥  Preparing Kubernetes v1.27.4 on Docker 24.0.4 ...
    ‚ñ™ Generating certificates and keys ...
    ‚ñ™ Booting up control plane ...
    ‚ñ™ Configuring RBAC rules ...
üîó  Configuring bridge CNI (Container Networking Interface) ...
    ‚ñ™ Using image gcr.io/k8s-minikube/storage-provisioner:v5
üîé  Verifying Kubernetes components...
üåü  Enabled addons: storage-provisioner, default-storageclass
üèÑ  Done! kubectl is now configured to use "minikube" cluster and "default" namespace by default
```
–î–æ–ø–æ–ª–Ω—é, —á—Ç–æ –Ω–∞ –º–∞—à–∏–Ω—É –±—ã–ª —Ç–∞–∫–∂–µ –æ—Ç–¥–µ–ª—å–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω `kubectl` –¥–ª—è –±–æ–ª–µ–µ —É–¥–æ–±–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞–º–∏. 
#### –ó–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ vault
–î–ª—è –∑–∞–ø—É—Å–∫–∞ –ø–æ–¥–∞ –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –º–∞–Ω–∏—Ñ–µ—Å—Ç –ø–æ–¥–∞ .yaml. –ü–æ—Å–∫–æ–ª—å–∫—É —è —è–≤–ª—è—é—Å—å –ø–æ–ª–Ω—ã–º –Ω—É–±–æ–º –≤ Docker –∏ k8s –∏ –∫—É—Ä—Å –Ω–∞ edX —Ç–æ–ª—å–∫–æ –Ω–∞—á–∞–ª –ø—Ä–æ—Ö–æ–¥–∏—Ç—å, —Ç–æ –Ω–∞ –ø–æ–º–æ—â—å –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ –ø—Ä–∏—à–ª–∞ [—Å—Ç–∞—Ç—å—è –Ω–∞ –•–∞–±—Ä–µ](https://habr.com/ru/articles/589415/) –∏ —à–∞–±–ª–æ–Ω –º–∞–Ω–∏—Ñ–µ—Å—Ç–∞ –∏–∑ —Å—Ç–∞—Ç—å–∏. –°–æ–∑–¥–∞–Ω `vault.yaml`:
```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: vault
  labels:
    app: vault
spec:
  replicas: 1
  selector:
    matchLabels:
      app: vault
  template:
    metadata:
      labels:
        app: vault
    spec:
      containers:
      - name: vault
        image: vault:1.13.3
        ports:
        - containerPort: 8200
```
–¢–∞–∫–∂–µ –¥–ª—è –∫—Ä–∞—Å–æ—Ç—ã –ø–æ —Å–æ–≤–µ—Ç—É –∏–∑ —Å—Ç–∞—Ç—å–∏ —è —Å–æ–∑–¥–∞–ª –æ—Ç–¥–µ–ª—å–Ω—ã–π namespace –¥–ª—è –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ–π –∏ –∑–∞–ø—É—Å—Ç–∏–ª –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –≤ –Ω—ë–º. –°–æ–∑–¥–∞–ª `lab1.yaml`:
```yaml
apiVersion: v1
kind: Namespace
metadata:
  name: lab1
```
–ó–∞—Ç–µ–º –ø—Ä–∏–º–µ–Ω–∏–ª –º–∞–Ω–∏—Ñ–µ—Å—Ç –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ –∏–º—ë–Ω 
```bash
$ kubectl apply -f lab1.yaml
```
–ò –∑–∞–ø—É—Å—Ç–∏–ª –≤ –Ω—ë–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
```bash
$ kubectl apply -f vault.yaml --namespace lab1
deployment.apps/vault created
```
–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞:
```bash
$ kubectl get pods -n lab1
NAME                     READY   STATUS    RESTARTS   AGE
vault-5b56bbdcc8-fdrc4   1/1     Running   0          18s
```
#### –°–µ—Ä–≤–∏—Å –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—É
–°–æ–∑–¥–∞–¥–∏–º —Å–µ—Ä–≤–∏—Å –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—É, –∏—Å–ø–æ–ª—å–∑—É—è –∫–æ–º–∞–Ω–¥—É –∏–∑ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞ –∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—é —Ä–∞–±–æ—Ç—ã:
```bash
$ minikube kubectl -- expose pod vault-5b56bbdcc8-fdrc4 --type=NodePort --port=8200 --namespace=lab1
service/vault-5b56bbdcc8-fdrc4 exposed
```
–ü—Ä–æ–∫–∏–Ω–µ–º –ø–æ—Ä—Ç 8200 –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∫–æ–º–∞–Ω–¥–æ–π –∏–∑ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞:
```bash
$ minikube kubectl -- port-forward service/vault-5b56bbdcc8-fdrc4 8200:8200 --namespace=lab1
```
–ù–∞ —Å–∫—Ä–∏–Ω–µ –Ω–∏–∂–µ –ø—Ä–∏–≤–µ–¥—ë–Ω –ø—Ä–∏–º–µ—Ä –¥–æ—Å—Ç—É–ø–∞ –∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—É —á–µ—Ä–µ–∑ –≤–µ–±-–±—Ä–∞—É–∑–µ—Ä:
![img1](https://github.com/sanchpet/2023_2024-introduction_to_distributed_technologies-k4113c-petrov_a_d/blob/main/lab1/img/Pasted%20image%2020231004123309.png)
#### –ü–æ–∏—Å–∫ —Ç–æ–∫–µ–Ω–∞
–û—Ç–ø—Ä–∞–≤–∏–º –ø—Ä–æ—Ü–µ—Å—Å –ø—Ä–æ–±—Ä–æ—Å–∞ —Å–µ—Ä–≤–∏—Å–∞ –≤ background (`^Z`, `bg`) –∏ –ø—Ä–æ–≤–µ—Ä–∏–º –ª–æ–≥–∏ –ø–æ–¥–∞:
```bash
$ kubectl logs vault-5b56bbdcc8-fdrc4 --namespace=lab1
```
–í –∫–æ–Ω—Ü–µ –ª–æ–≥–∞ –≤–∏–¥–Ω–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç–æ–∫–µ–Ω:
```
The unseal key and root token are displayed below in case you want to
seal/unseal the Vault or re-authenticate.

Unseal Key: ccGwtjpshMkrcd7x7pbKZr+Q2KreLpO3x1O6wFfrvf8=
Root Token: hvs.F0BQOHL47ERZthKWRYD4Fna0
```
–ê–≤—Ç–æ—Ä–∏–∑—É–µ–º—Å—è –≤ Vault:
![img2](https://github.com/sanchpet/2023_2024-introduction_to_distributed_technologies-k4113c-petrov_a_d/blob/main/lab1/img/Pasted%20image%2020231004124532.png)
#### –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–ª–∞—Å—Ç–µ—Ä–∞
–ü—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–∏–º –ø—Ä–æ—Ü–µ—Å—Å –ø—Ä–æ–±—Ä–æ—Å–∞ –ø–æ—Ä—Ç–∞ –Ω–∞ —Å–µ—Ä–≤–∏—Å –∏ –∑–∞–≤–µ—Ä—à–∏–º —Ä–∞–±–æ—Ç—É –∫–ª–∞—Å—Ç–µ—Ä–∞:
```bash
$ jobs
[1]+  Running                 minikube kubectl -- port-forward service/vault-5b56bbdcc8-fdrc4 8200:8200 --namespace=lab1 &
$ kill %1
$ minikube stop
‚úã  Stopping node "minikube"  ...
üõë  Powering off "minikube" via SSH ...
üõë  1 node stopped.
```

### –°—Ö–µ–º–∞ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ –∏ —Å–µ—Ä–≤–∏—Å–æ–≤

![[Pasted image 20231004155856.png]]

### –í–æ–ø—Ä–æ—Å—ã –∫ —Ä–∞–±–æ—Ç–µ

#### 1. –ß—Ç–æ —Å–µ–π—á–∞—Å –ø—Ä–æ–∏–∑–æ—à–ª–æ –∏ —á—Ç–æ —Å–¥–µ–ª–∞–ª–∏ –∫–æ–º–∞–Ω–¥—ã —É–∫–∞–∑–∞–Ω–Ω—ã–µ —Ä–∞–Ω–µ–µ?
–ë—ã–ª –∑–∞–ø—É—â–µ–Ω –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å —Å–µ—Ä–≤–∏—Å–æ–º Vault - —É—Ç–∏–ª–∏—Ç–æ–π –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–µ–∫—Ä–µ—Ç–æ–≤. –ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–æ —Å –ø–æ–º–æ—â—å—é —É–∫–∞–∑–∞–Ω–Ω—ã—Ö –≤—ã—à–µ –∫–æ–º–∞–Ω–¥ –±—ã–ª –∑–∞–ø—É—â–µ–Ω –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –≤–Ω—É—Ç—Ä–∏ Minikube. –î–ª—è —Ä–∞–±–æ—Ç—ã –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—É –±—ã–ª —É–∫–∞–∑–∞–Ω –ø–æ—Ä—Ç 8200, –∞ –≤–ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏–∏ –±—ã–ª —Å–æ–∑–¥–∞–Ω –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å –∞–±—Å—Ç—Ä–∞—Ü–∏–∏ - —Å–µ—Ä–≤–∏—Å –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—É. –°–µ—Ä–≤–∏—Å –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –¥–æ—Å—Ç—É–ø –Ω–∞ –ø–æ—Ä—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞. –ü–æ—Å–ª–µ–¥–Ω–µ–π –∫–æ–º–∞–Ω–¥–æ–π –±—ã–ª –Ω–∞—Å—Ç—Ä–æ–µ–Ω –ø—Ä–æ–±—Ä–æ—Å –ø–æ—Ä—Ç–∞ 8200 –Ω–∞ localhost –≤ –ø–æ—Ä—Ç 8200 –Ω–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ. 
#### 2. –ì–¥–µ –≤–∑—è—Ç—å —Ç–æ–∫–µ–Ω –¥–ª—è –≤—Ö–æ–¥–∞ –≤ Vault?
–ö–∞–∫ –±—ã–ª–æ –ø—Ä–æ–¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–æ –≤—ã—à–µ, —Ç–æ–∫–µ–Ω –º–æ–∂–Ω–æ —É–∑–Ω–∞—Ç—å –∏–∑ –ª–æ–≥–∞ –ø–æ–¥–∞.
